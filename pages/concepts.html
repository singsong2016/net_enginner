<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>

<body>
<p>冲突域<br />
</p>
<p>冲突域是数据必然发送到的区域。<br />
  HUB是无智能的信号驱动器，有入必出，整个由HUB组成的网络是一个冲突域。<br />
  交换机的一个接口下的网络是一个冲突域，所以交换机可以隔离冲突域。<br />
  广播域<br />
  广播数据时可以发送到的区域是一个广播域。<br />
  交换机和集线器对广播帧是透明的，所以用交换机和HUB组成的网络是一个广播域。<br />
  路由器的一个接口下的网络是一个广播域。所以路由器可以隔离广播域。<br />
  Ethernet接线方法<br />
  两边采用相同的接线方式叫做平接，两边采用不同的接线方式叫扭接。<br />
  不同的设备之间连接，使用平接线；相同的设备连接使用扭接线。<br />
  电脑、路由器与集线器、交换机连接时使用平接线。<br />
  这是因为网线中的4条线，一对是输入，一对是输出，输入应该与输出对应。<br />
  如果将1和3连接，2和6连接，相当于自己的输出送给自己的输入。<br />
  这样可以使网卡进入工作状态，阻止空接口关闭，而影响有些程序的运行。</p>
<p>&nbsp;</p>
<p>SWITCHER工作原理</p>
<p>地址表</p>
<p>端口地址表记录了端口下包含主机的MAC地址。端口地址表是交换机上电后自动建立的，<br />
  保存在RAM中，并且自动维护。<br />
  交换机隔离冲突域的原理是根据其端口地址表和转发决策决定的。</p>
<p>转发决策</p>
<p>交换机的转发决策有三种操作：丢弃、转发和扩散。<br />
  丢弃：当本端口下的主机访问已知本端口下的主机时丢弃。<br />
  转发：当某端口下的主机访问已知某端口下的主机时转发。<br />
  扩散：当某端口下的主机访问未知端口下的主机时要扩散。<br />
  每个操作都要记录下发包端的MAC地址，以备其它主机的访问。</p>
<p>生存期</p>
<p>生存期是端口地址列表中表项的寿命。每个表项在建立后开始进行倒记时，每次发送<br />
  数据都要刷新记时。对于长期不发送数据主机，其MAC地址的表项在生存期结束时删除。<br />
  所以端口地址表记录的总是最活动的主机的MAC地址。<br />
  (4)应该说交换机有很多值得学习的地方，这里我们主要介绍交换机结构及组网方式，21世纪10年代以来网络应用越来越广泛，交换机作为网络中的纽带发挥了越来越大的作用。简单的说，交换机就是将它与用户计算机相连就行了，完成各个计算机之间的数据交换。复杂来说，交换机针对在整个网络中的位置而言，一些高层交换机如三层交换、网管型的产品，在交换机结构方面就没这么简单了。</p>
<p>三层路由</p>
<p>通常，普通的交换机只工作在数据链路层上，路由器则工作在网络层。而功能强大的三层交换机可同时工作在数据链路层和网络层，并根据 MAC地址或IP地址转发数据包。但是要注意到三层交换机并不能完全取代路由器，因为它主要是为了实现处于两个不同子网的Vlan进行通讯，而不是用来作数据传输的复杂路径选择。</p>
<p>网管功能</p>
<p>一台交换机所支持的管理程度反映了该设备的可管理性与可操作性。带网管功能的交换机可对每个端口的流量进行监测，设置每个端口的速率，关闭/打开端口连接。通过对交换机端口进行监测，便于对网络业务流量的区分和迅速进行网络故障定义，提高了网络的可管理性。</p>
<p>端口聚合</p>
<p>这是一种封装技术，它是一条点到点的链路，链路的两端可以都是交换机，也可以是交换机和路由器，还可以是主机和交换机或路由器。基于端口汇聚（Trunk）功能，允许交换机与交换机、交换机与路由器、主机与交换机或路由器之间通过两个或多个端口并行连接同时传输以提供更高带宽、更大吞吐量， 大幅度提供整个网络能力。</p>
<p>&nbsp;</p>
<p>三层概念编辑</p>
<p>链路层</p>
<p>使用MAC地址，完成对帧的操作。<br />
  交换机的IP地址做管理用，交换机的IP地址实际是VALN的IP。<br />
  一个VLAN一个广播域，不同VLAN的主机间访问，相当于网络间的访问，要通过路由实现。<br />
  不同VLAN间主机的访问有以下几种情况：<br />
  (1)两个VLAN分别接入路由器的两个物理接口。这是路由器的基本应用。<br />
  (2)两个VLAN通过trunk接入路由器的一个物理接口，这是应用于子接口的单臂路由。<br />
  (3)使用具有三层交换模块的交换机。Cisco的3550和华为的3526都是基本的三层交换机。<br />
  1)通过VLAN的IP地址做网关，实现三层交换，要求设置VLAN的IP地址。<br />
  2)将端口设置在三层工作，要求端口设置no switchport，再设置端口的IP地址。[3] </p>
<p>通道技术</p>
<p>交换机通道技术是将交换机的几个端口捆绑使用，即端口的聚合。<br />
  使用通道技术一个方面提高了带宽，同时提高了线路的可靠性。<br />
  但是如果设置不当，有可能产生环路，造成广播风暴堵塞网络。<br />
  要聚合的端口要划分到指定的VLAN或trunk。<br />
  配置三层通道时，先要进入通道，再用no switchport命令关闭二层，设置通道IP地址。<br />
  一个通道一般小于8个接口，接口参数应该一致，如工作模式、封装的协议、端口类型。</p>
<p>协商方式</p>
<p>端口的聚合有两种方式，一种是手动的方式，一个是自动协商的方式。<br />
  手动的方式很简单，设置端口成员链路两端的模式为&quot;on&quot;。命令格式为：<br />
  channel-group &lt;number&gt; mode on<br />
  自动方式有两种类型：<br />
  PAgP(Port Aggregation Protocol)和LACP(Link aggregation Control Protocol)。<br />
  PAgP：Cisco设备的端口聚合协议，有auto和desirable两种模式。<br />
  auto模式在协商中只收不发，desirable模式的端口收发协商的数据包。<br />
  LACP：标准的端口聚合协议802.3ad，有active和passive两种模式。<br />
  active相当于PAgP的auto，而passive相当于PAgP的desirable。</p>
<p>负载平衡</p>
<p>通道端口间的负载平衡有两种方式，基于源MAC的转发和基于目的MAC的转发。<br />
  scr-mac：源MAC地址相同的数据帧使用同一个端口转发。<br />
  dst-mac：目的MAC地址相同的数据帧使用同一个端口转发。</p>
<p>四层技术编辑</p>
<p>随着宽带的普及，各种网络应用的深入，我们的局域网络正在承担着繁重的业务流量。网络系统中的音频、视频、数据等信息的传输量充斥着占用带宽，我们不得不为这些数据流量提供差别化的服务，让时延敏感性的和重要的数据优先通过，这就不得不考虑第四层交换，以满足基于策略调度、QoS（Quality of Service：服务质量）以及安全服务的需求。</p>
<p>区别</p>
<p>第二层交换实现局域网内主机间的快速信息交流，第三层交换可以说是交换技术与路由技术的完美结合，而第四层交换技术则可以为网络应用资源提供最优分配，实现应用服务服务质量、负载均衡及安全控制。四层交换并不是要取代谁，其实2013年径渭分明的二层交换和三层交换已融入四层交换技术。<br />
  第二层交换机，是根据第二层数据链路层的MAC地址和MAC地址表来完成端到端的数据交换的。第二层交换机只须识别数据帧中的MAC地址，而直接根据MAC地址转发，非常便于采用ASIC专用芯片实现。第二层交换的解决方案，是一个&quot;处处交换&quot;的方案，虽然该方案也能划分子网、限制广播、建立VLAN，但它的控制能力较小、灵活性不够，也无法控制流量，缺乏路由功能。<br />
  第三层交换机，是根据第三层的网络层IP地址来完成端到端的数据交换的，主要应用于不同VLAN子网间的路由。当某一信息源的第一个数据流进行第三层交换（路由）后，交换机会产生一个MAC地址与IP地址的映射表，并将该表存储起来，如同一信息源的后续数据流再次进入交换机，交换机将根据第一次产生并保存的地址映射表，直接从第二层由源地址传输到目的地址，不再经过第三路由系统处理，提高了数据包的转发效率，解决了VLAN子网间传输信息时传统路由器产生的速率瓶颈。<br />
  第四层交换机不仅可以完成端到端交换，还能根据端口主机的应用特点，确定或限制它的交换流量。简单地说，第四层交换机是基于传输层数据包的交换过程的，是一类基于TCP/IP协议应用层的用户应用交换需求的新型局域网交换机。第四层交换机支持TCP/UDP第四层以下的所有协议，可根据TCP/UDP端口号来区分数据包的应用类型，从而实现应用层的访问控制和服务质量保证。可以查看第三层数据包头源地址和目的地址的内容，可以通过基于观察到的信息采取相应的动作，实现带宽分配、故障诊断和对TCP/IP应用程序数据流进行访问控制的关键功能。第四层交换机通过任务分配和负载均衡优化网络，并提供详细的流量统计信息和记帐信息，从而在应用的层级上解决网络拥塞、网络安全和网络管理等问题，使网络具有智能和可管理。</p>
<p>技术简介</p>
<p>OSI网络参考模型的第四层是传输层。传输层负责端到端通信，即在网络源和目标系统之间协调通信。在IP协议栈中这是TCP（传输控制协议）和UDP（用户数据报协议）所在的协议层。TCP和UDP包含端口号，它可以唯一区分每个数据包包含哪些应用协议（例如HTTP、FTP、telnet等等）。TCP/UDP端口号提供的附加信息可以为网络交换机所利用，四层交换机利用这种信息来区分包中的数据，这是第四层交换的基础</p>
<p>功能介绍</p>
<p>1．数据包过滤：在传统路由器上，采用第四层信息端口号去定义访问控制列表过滤规则。四层交换也借用了控制列表的概念，但和基于软件的路由器不一样，第四层交换是在ASIC专用高速芯片中实现的，从而使过滤控制可以线速进行。<br />
  2．服务质量：TCP/UDP第四层信息还可以用于建立应用通信的优先级。第四层交换允许用基于端口号（应用）来区分优先级，设置优先级队列，确保重要的流量（如：VOIP、视频）在得到最快的处理，使紧急应用获得网络的高级别服务。<br />
  3．负载均衡：第四层交换负载均衡的原理，就是按照IP地址和TCP端口进行虚拟连接的交换，直接将数据包发送到目的计算机的相应端口中。具备第四层交换能力的交换机，能作为一个硬件负载均衡器，完成服务器的负载均衡。由于第四层交换基于硬件芯片，因此性能非常优秀，尤其是对于网络传输的速度，交换的速度远远超过普通的数据包转发。采用第四层交换机设备，所有的集群主机通过第四层交换机与外部Internet相连，外部客户防问服务器时通过第四层交换机动态分配服务器，实现动态负载均衡，当其中一台服务器出现故障时，由交换机动态将所有流量分配到集群中的其他主机上,这类只适合在大型流量大的服务器。<br />
  4．主机备用连接：主机备用连接为端口设备提供了冗余连接，从而在交换机发生故障时有效保护系统，这种服务允许定义主备交换机，同虚拟服务器定义一样，它们有相同的配置参数。由于第四层交换机共享相同的MAC地址，备份交换机接收和主单元全部一样的数据。这使得备份交换机能够监视主交换机服务的通信内容。主交换机持续地通知备份交换机第四层的有关数据、MAC数据以及它的电源状况。主交换机失败时，备份交换机就会自动接管，不会中断对话或连接。<br />
  5．统计与报告：通过查询第四层数据包，第四层交换机能够提供更详细的统计记录。因为管理员可以收集到更详细的哪一个IP地址在进行通信的信息，甚至可根据通信中涉及到哪一个应用层服务来收集通信信息。当服务器支持多个服务时，这些统计对于考察服务器上每个应用的负载尤其有效。增加的统计服务对于使用交换机的服务器负载均衡服务连接同样十分有用。包含详尽的实时报告和历史纪录报告，全面的报告功能为管理员提供了对带宽资源的充分掌握，从而使企业可以作出更合适的业务决策。<br />
  第四层交换机在业界有一通用的名字叫做&quot;应用交换机&quot;，比较有名的有如下几款：<br />
  美国的F5公司的BIG-IP 2400系列链路应用交换机可实定制负载平衡，流量优先级安排，基于政策的流量引导，来源、目的地和应用交换。<br />
  Radware公司的Web Server Director应用交换机可保障服务器群的完全可用性、优化运行以及完备的安全性，从而保证网络和数据中心范围内的应用能获得高度可靠性和性能。<br />
  美国Foundry公司 ServerIronGT-C2404F应用交换机可实现全局服务器负载均衡,高性能 VPN/防火墙负载均衡，透明缓存交换，链路负载均衡，防DoS攻击保护服务器。</p>
<p>总结</p>
<p>随着网络信息系统由小型到中型到大型的发展趋势，交换技术也由原来最初的基于MAC地址的交换，发展到基于IP地址的交换，进一步发展到基于IP+端口的交换，本文对第四层交换技术作了一个比较全面的介绍，如今也有产品更提出了第七层交换（基于内容的交换）。可见，网络交换技术的不断发展使得原来由基于数据的交换变成了基于应用的交换，不仅提高了网络的访问速度，而且不断地优化了网络的整体性能。</p>
<p></p>
</body>
</html>
